<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet">
    <style>
        /* ===== ROOT VARIABLES & RESET ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #e50914;
            --secondary-color: #b81d24;
            --dark-bg: #141414;
            --light-bg: #1f1f1f;
            --text-color: #ffffff;
            --text-secondary: #b3b3b3;
            --card-bg: #2d2d2d;
            --trending-color: #ff6b00;
            --search-color: #00a8ff;
            --success-color: #4CAF50;
            --warning-color: #ff9800;
            --error-color: #f44336;
        }

        body {
            background-color: var(--dark-bg);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* ===== HEADER STYLES ===== */
        header {
            background-color: rgba(0, 0, 0, 0.95);
            padding: 20px 5%;
            position: fixed;
            width: 100%;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        header.scrolled {
            padding: 15px 5%;
            background-color: rgba(0, 0, 0, 0.98);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo h1 {
            color: var(--primary-color);
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary-color), #ff6b00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo i {
            color: var(--primary-color);
            font-size: 32px;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        nav a {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            font-size: 18px;
            transition: color 0.3s;
            position: relative;
            padding: 5px 0;
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary-color);
            transition: width 0.3s;
        }

        nav a:hover::after,
        nav a.active::after {
            width: 100%;
        }

        nav a:hover {
            color: var(--primary-color);
        }

        /* ===== SEARCH CONTAINER ===== */
        .search-container {
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }

        .search-container input {
            padding: 10px 15px;
            border-radius: 4px;
            border: 1px solid #444;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            width: 250px;
            transition: all 0.3s;
        }

        .search-container input:focus {
            outline: none;
            border-color: var(--search-color);
            box-shadow: 0 0 0 2px rgba(0, 168, 255, 0.3);
            width: 300px;
        }

        .search-container button {
            background-color: var(--search-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }

        .search-container button:hover {
            background-color: #0097e6;
            transform: scale(1.05);
        }

        /* ===== SEARCH RESULTS DROPDOWN ===== */
        .search-results {
            position: absolute;
            top: 100%;
            right: 0;
            width: 100%;
            max-height: 400px;
            overflow-y: auto;
            background-color: var(--light-bg);
            border-radius: 4px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1001;
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            padding: 15px;
            border-bottom: 1px solid #333;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .search-result-item:hover {
            background-color: var(--card-bg);
        }

        .search-result-item img {
            width: 60px;
            height: 85px;
            object-fit: cover;
            border-radius: 4px;
        }

        .search-result-info h4 {
            color: white;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .search-result-info p {
            color: var(--text-secondary);
            font-size: 14px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .view-all-results {
            padding: 15px;
            text-align: center;
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .view-all-results:hover {
            background-color: var(--secondary-color);
        }

        /* ===== MOBILE MENU BUTTON ===== */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
        }

        /* ===== HERO SECTION ===== */
        .hero {
            padding: 150px 5% 80px;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7), var(--dark-bg)), 
                        url('https://images.unsplash.com/photo-1574269909862-7e1d70bb8078?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(229, 9, 20, 0.1), rgba(255, 107, 0, 0.1));
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero h2 {
            font-size: 48px;
            margin-bottom: 20px;
            color: white;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
            animation: fadeInDown 1s ease;
        }

        .hero p {
            font-size: 22px;
            max-width: 800px;
            margin: 0 auto 40px;
            color: #f0f0f0;
            animation: fadeInUp 1s ease 0.3s both;
        }

        .cta-button {
            background: linear-gradient(45deg, var(--primary-color), var(--trending-color));
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            animation: fadeIn 1s ease 0.6s both;
            box-shadow: 0 8px 20px rgba(229, 9, 20, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 30px rgba(229, 9, 20, 0.4);
        }

        /* ===== MAIN CONTENT ===== */
        .container {
            padding: 60px 5%;
        }

        .section-title {
            font-size: 32px;
            margin-bottom: 30px;
            color: white;
            border-left: 5px solid var(--primary-color);
            padding-left: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title.trending {
            border-left-color: var(--trending-color);
        }

        .section-title.trending i {
            color: var(--trending-color);
            animation: fire 2s infinite;
        }

        .section-title.search-results-title {
            border-left-color: var(--search-color);
        }

        .section-title.search-results-title i {
            color: var(--search-color);
        }

        /* ===== DRAMA GRID ===== */
        .drama-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .drama-card {
            background-color: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            position: relative;
        }

        .drama-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.7);
        }

        .drama-card.trending {
            border: 2px solid var(--trending-color);
        }

        .drama-card.search-result {
            border: 2px solid var(--search-color);
        }

        .card-image {
            position: relative;
            height: 380px;
            overflow: hidden;
        }

        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform 0.5s;
        }

        .drama-card:hover .card-image img {
            transform: scale(1.1);
        }

        .age-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 14px;
            z-index: 2;
        }

        .trending-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: linear-gradient(45deg, var(--trending-color), #ff8c00);
            color: white;
            padding: 5px 15px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 14px;
            z-index: 2;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .search-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: linear-gradient(45deg, var(--search-color), #0097e6);
            color: white;
            padding: 5px 15px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 14px;
            z-index: 2;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .drama-info {
            padding: 20px;
        }

        .drama-info h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: white;
            height: 50px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .drama-info p {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 15px;
            height: 60px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .drama-meta {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .drama-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .watch-btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            width: 100%;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .watch-btn:hover {
            background: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(229, 9, 20, 0.3);
        }

        .watch-btn.trending {
            background: linear-gradient(45deg, var(--trending-color), #ff8c00);
        }

        .watch-btn.trending:hover {
            background: linear-gradient(45deg, #ff8c00, var(--trending-color));
        }

        .watch-btn.search-result {
            background: linear-gradient(45deg, var(--search-color), #0097e6);
        }

        .watch-btn.search-result:hover {
            background: linear-gradient(45deg, #0097e6, var(--search-color));
        }

        /* ===== LOADING STATES ===== */
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 20px;
            grid-column: 1 / -1;
        }

        .loading i {
            color: var(--primary-color);
            font-size: 40px;
            margin-bottom: 20px;
            animation: spin 2s linear infinite;
        }

        /* ===== FILTER CONTAINER ===== */
        .filter-container {
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background-color: var(--light-bg);
            color: var(--text-color);
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-btn.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            transform: scale(1.05);
        }

        .filter-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        /* ===== SEARCH RESULTS SECTION ===== */
        .search-results-section {
            display: none;
        }

        .search-results-section.active {
            display: block;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            background-color: var(--light-bg);
            border-radius: 10px;
            margin-bottom: 50px;
        }

        .no-results i {
            font-size: 60px;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .no-results h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 24px;
        }

        .no-results p {
            color: var(--text-secondary);
            font-size: 18px;
            max-width: 600px;
            margin: 0 auto;
        }

        /* ===== DRAMA MODAL ===== */
        .drama-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            overflow-y: auto;
            padding: 40px 5%;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: var(--light-bg);
            border-radius: 10px;
            max-width: 1000px;
            margin: 0 auto;
            overflow: hidden;
            animation: slideUp 0.5s ease;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            padding: 30px;
            background: linear-gradient(135deg, var(--primary-color), var(--dark-bg));
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .modal-header h2 {
            font-size: 32px;
            color: white;
            max-width: 80%;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 30px;
            cursor: pointer;
            transition: transform 0.3s;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            transform: rotate(90deg);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .modal-body {
            padding: 30px;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
        }

        .modal-poster {
            border-radius: 8px;
            overflow: hidden;
            height: 450px;
        }

        .modal-poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .modal-info h3 {
            font-size: 24px;
            margin-bottom: 20px;
            color: white;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .modal-info p {
            margin-bottom: 20px;
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .modal-details {
            background-color: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .modal-details ul {
            list-style: none;
        }

        .modal-details li {
            margin-bottom: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-details li strong {
            color: white;
            min-width: 120px;
            display: inline-block;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .modal-actions button {
            padding: 15px 30px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex: 1;
        }

        .play-btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .play-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(229, 9, 20, 0.3);
        }

        .trailer-btn {
            background-color: transparent;
            color: white;
            border: 2px solid white !important;
        }

        .trailer-btn:hover {
            background-color: white;
            color: var(--dark-bg);
            transform: translateY(-3px);
        }

        /* ===== VIDEO PLAYER MODAL ===== */
        .video-player-modal .modal-content {
            max-width: 1000px !important;
            background-color: #000 !important;
        }

        .video-player-modal .modal-header {
            background: linear-gradient(135deg, #000, #333) !important;
            padding: 15px 20px !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
        }

        .video-player-modal .modal-header h2 {
            color: white !important;
            font-size: 20px !important;
            margin: 0 !important;
        }

        .player-controls-top {
            display: flex !important;
            gap: 10px !important;
            align-items: center !important;
        }

        .player-btn {
            background-color: rgba(255, 255, 255, 0.1) !important;
            color: white !important;
            border: none !important;
            padding: 8px 15px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            font-size: 14px !important;
            display: flex !important;
            align-items: center !important;
            gap: 5px !important;
        }

        .player-btn:hover {
            background-color: var(--primary-color) !important;
            transform: translateY(-2px) !important;
        }

        .video-container {
            position: relative !important;
            width: 100% !important;
            background-color: #000 !important;
            aspect-ratio: 16/9 !important;
        }

        .video-loading {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: center !important;
            align-items: center !important;
            background-color: rgba(0, 0, 0, 0.9) !important;
            color: white !important;
            z-index: 10 !important;
        }

        .video-loading i {
            font-size: 40px !important;
            color: var(--primary-color) !important;
            margin-bottom: 15px !important;
        }

        #mainVideoPlayer {
            width: 100% !important;
            height: 100% !important;
            background-color: #000 !important;
        }

        .custom-controls {
            position: absolute !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8)) !important;
            padding: 20px !important;
            z-index: 5 !important;
            opacity: 0 !important;
            transition: opacity 0.3s !important;
        }

        .video-container:hover .custom-controls {
            opacity: 1 !important;
        }

        .progress-container {
            width: 100% !important;
            margin-bottom: 15px !important;
        }

        .progress-bar {
            width: 100% !important;
            height: 6px !important;
            background-color: rgba(255, 255, 255, 0.2) !important;
            border-radius: 3px !important;
            cursor: pointer !important;
            position: relative !important;
            margin-bottom: 5px !important;
        }

        .progress-filled {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            height: 100% !important;
            background-color: var(--primary-color) !important;
            border-radius: 3px !important;
            width: 0% !important;
        }

        .progress-thumb {
            position: absolute !important;
            top: 50% !important;
            transform: translate(-50%, -50%) !important;
            width: 16px !important;
            height: 16px !important;
            background-color: var(--primary-color) !important;
            border-radius: 50% !important;
            cursor: pointer !important;
            left: 0% !important;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5) !important;
        }

        .time-display {
            display: flex !important;
            justify-content: space-between !important;
            color: white !important;
            font-size: 14px !important;
            margin-top: 5px !important;
        }

        .control-buttons {
            display: flex !important;
            align-items: center !important;
            gap: 15px !important;
            flex-wrap: wrap !important;
        }

        .control-btn {
            background: none !important;
            border: none !important;
            color: white !important;
            font-size: 18px !important;
            cursor: pointer !important;
            padding: 8px !important;
            border-radius: 4px !important;
            transition: all 0.3s !important;
            display: flex !important;
            align-items: center !important;
            gap: 5px !important;
        }

        .control-btn:hover {
            background-color: rgba(255, 255, 255, 0.1) !important;
            transform: scale(1.1) !important;
        }

        .volume-slider {
            flex: 1 !important;
            max-width: 100px !important;
        }

        .volume-slider input {
            width: 100% !important;
            height: 4px !important;
            -webkit-appearance: none !important;
            background: rgba(255, 255, 255, 0.2) !important;
            border-radius: 2px !important;
            outline: none !important;
        }

        .volume-slider input::-webkit-slider-thumb {
            -webkit-appearance: none !important;
            width: 14px !important;
            height: 14px !important;
            background: var(--primary-color) !important;
            border-radius: 50% !important;
            cursor: pointer !important;
        }

        .volume-slider input::-moz-range-thumb {
            width: 14px !important;
            height: 14px !important;
            background: var(--primary-color) !important;
            border-radius: 50% !important;
            cursor: pointer !important;
            border: none !important;
        }

        .video-info-panel {
            padding: 20px !important;
            background-color: var(--light-bg) !important;
            border-top: 1px solid #333 !important;
        }

        .video-info-header h3 {
            color: white !important;
            margin-bottom: 10px !important;
            font-size: 18px !important;
        }

        .video-stats {
            display: flex !important;
            gap: 20px !important;
            color: var(--text-secondary) !important;
            font-size: 14px !important;
        }

        .video-stats span {
            display: flex !important;
            align-items: center !important;
            gap: 5px !important;
        }

        .video-description {
            color: var(--text-secondary) !important;
            font-size: 14px !important;
            line-height: 1.6 !important;
            margin-bottom: 20px !important;
        }

        .video-quality-info {
            display: flex !important;
            gap: 15px !important;
            align-items: center !important;
        }

        .quality-badge {
            background-color: rgba(0, 168, 255, 0.2) !important;
            color: var(--search-color) !important;
            padding: 5px 12px !important;
            border-radius: 20px !important;
            font-size: 14px !important;
            display: flex !important;
            align-items: center !important;
            gap: 5px !important;
            border: 1px solid var(--search-color) !important;
        }

        .quality-badge.auto {
            background-color: rgba(229, 9, 20, 0.2) !important;
            color: var(--primary-color) !important;
            border-color: var(--primary-color) !important;
        }

        .quality-badge.720p {
            background-color: rgba(255, 107, 0, 0.2) !important;
            color: var(--trending-color) !important;
            border-color: var(--trending-color) !important;
        }

        .resolution-info {
            color: var(--text-secondary) !important;
            font-size: 14px !important;
            display: flex !important;
            align-items: center !important;
            gap: 5px !important;
        }

        /* ===== QUALITY & SUBTITLE MODALS ===== */
        .quality-modal, .subtitle-modal {
            display: none !important;
            position: absolute !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
            background-color: var(--light-bg) !important;
            border-radius: 10px !important;
            padding: 20px !important;
            z-index: 100 !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5) !important;
            min-width: 300px !important;
        }

        .quality-options, .subtitle-options {
            margin-bottom: 20px !important;
        }

        .quality-option, .subtitle-option {
            padding: 12px 15px !important;
            background-color: var(--card-bg) !important;
            border-radius: 8px !important;
            margin-bottom: 10px !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
            border: 2px solid transparent !important;
        }

        .quality-option:hover, .subtitle-option:hover {
            background-color: rgba(255, 255, 255, 0.1) !important;
            transform: translateX(5px) !important;
        }

        .quality-option.active, .subtitle-option.active {
            border-color: var(--primary-color) !important;
            background-color: rgba(229, 9, 20, 0.1) !important;
        }

        .quality-desc {
            margin-left: auto !important;
            color: var(--text-secondary) !important;
            font-size: 12px !important;
        }

        .quality-actions, .subtitle-actions {
            display: flex !important;
            gap: 10px !important;
            justify-content: flex-end !important;
        }

        .quality-btn, .subtitle-btn {
            padding: 8px 20px !important;
            border-radius: 4px !important;
            border: none !important;
            cursor: pointer !important;
            font-weight: 600 !important;
            transition: all 0.3s !important;
        }

        .quality-btn:not(.cancel), .subtitle-btn:not(.cancel) {
            background-color: var(--primary-color) !important;
            color: white !important;
        }

        .quality-btn.cancel, .subtitle-btn.cancel {
            background-color: transparent !important;
            color: var(--text-secondary) !important;
            border: 1px solid var(--text-secondary) !important;
        }

        /* ===== EPISODE NAVIGATION ===== */
        .episode-navigation {
            display: flex !important;
            justify-content: space-between !important;
            padding: 15px 20px !important;
            background-color: var(--dark-bg) !important;
            border-top: 1px solid #333 !important;
        }

        .episode-nav-btn {
            background-color: var(--card-bg) !important;
            color: white !important;
            border: none !important;
            padding: 10px 20px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
        }

        .episode-nav-btn:hover {
            background-color: var(--primary-color) !important;
            transform: translateY(-2px) !important;
        }

        .episode-list-toggle {
            background-color: transparent !important;
            color: var(--text-secondary) !important;
            border: 1px solid var(--text-secondary) !important;
            padding: 10px 20px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
        }

        .episode-list-toggle:hover {
            color: white !important;
            border-color: white !important;
            background-color: rgba(255, 255, 255, 0.1) !important;
        }

        /* ===== EPISODE SIDEBAR ===== */
        .episode-sidebar {
            position: fixed !important;
            top: 0 !important;
            right: -400px !important;
            width: 350px !important;
            height: 100vh !important;
            background-color: var(--light-bg) !important;
            z-index: 1000 !important;
            transition: right 0.3s ease !important;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3) !important;
        }

        .episode-sidebar.active {
            right: 0 !important;
        }

        .episode-sidebar-header {
            padding: 20px !important;
            border-bottom: 1px solid #333 !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
        }

        .close-sidebar {
            background: none !important;
            border: none !important;
            color: white !important;
            font-size: 20px !important;
            cursor: pointer !important;
            padding: 5px !important;
            border-radius: 50% !important;
            width: 30px !important;
            height: 30px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        .episode-list {
            height: calc(100vh - 80px) !important;
            overflow-y: auto !important;
            padding: 15px !important;
        }

        .episode-item {
            display: flex !important;
            gap: 15px !important;
            padding: 10px !important;
            background-color: var(--card-bg) !important;
            border-radius: 8px !important;
            margin-bottom: 10px !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            border: 2px solid transparent !important;
        }

        .episode-item:hover {
            background-color: rgba(255, 255, 255, 0.1) !important;
            transform: translateX(-5px) !important;
        }

        .episode-item.active {
            border-color: var(--primary-color) !important;
            background-color: rgba(229, 9, 20, 0.1) !important;
        }

        /* ===== FOOTER ===== */
        footer {
            background-color: #000;
            padding: 50px 5% 30px;
            margin-top: 50px;
            border-top: 1px solid #333;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-column h3 {
            font-size: 20px;
            margin-bottom: 20px;
            color: white;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 10px;
        }

        .footer-column ul li a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-column ul li a:hover {
            color: var(--primary-color);
            transform: translateX(5px);
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid #333;
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* ===== ANIMATIONS ===== */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes fire {
            0%, 100% {
                color: var(--trending-color);
                transform: scale(1);
            }
            50% {
                color: #ff8c00;
                transform: scale(1.1);
            }
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .hero h2 {
                font-size: 42px;
            }
            .hero p {
                font-size: 20px;
            }
        }

        @media (max-width: 992px) {
            .modal-body {
                grid-template-columns: 1fr;
            }
            .modal-poster {
                height: 400px;
                max-width: 300px;
                margin: 0 auto;
            }
            nav ul {
                display: none;
            }
            .mobile-menu-btn {
                display: block;
            }
            .hero h2 {
                font-size: 36px;
            }
            .hero p {
                font-size: 18px;
            }
        }

        @media (max-width: 768px) {
            .search-container input {
                width: 200px;
            }
            .search-container input:focus {
                width: 250px;
            }
            .drama-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }
            .hero h2 {
                font-size: 32px;
            }
            .hero p {
                font-size: 16px;
            }
            .modal-header h2 {
                font-size: 24px;
            }
            .modal-actions {
                flex-direction: column;
            }
            .video-player-modal .modal-content {
                max-width: 100% !important;
                height: 100vh !important;
                border-radius: 0 !important;
            }
            .video-container {
                aspect-ratio: 9/16 !important;
                height: 60vh !important;
            }
            .control-buttons {
                justify-content: space-around !important;
            }
            .volume-slider {
                display: none !important;
            }
            .episode-sidebar {
                width: 100% !important;
                right: -100% !important;
            }
        }

        @media (max-width: 576px) {
            header {
                flex-direction: column;
                gap: 20px;
                padding: 15px 5%;
            }
            header.scrolled {
                padding: 10px 5%;
            }
            .search-container {
                width: 100%;
            }
            .search-container input {
                width: 100%;
            }
            .search-container input:focus {
                width: 100%;
            }
            .hero {
                padding: 180px 5% 60px;
            }
            .hero h2 {
                font-size: 28px;
            }
            .hero p {
                font-size: 16px;
            }
            .section-title {
                font-size: 24px;
            }
            .modal-header {
                padding: 20px;
            }
            .modal-body {
                padding: 20px;
            }
            .modal-poster {
                height: 350px;
            }
            .footer-content {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            .video-player-modal .modal-header {
                flex-direction: column !important;
                gap: 10px !important;
                align-items: flex-start !important;
            }
            .player-controls-top {
                width: 100% !important;
                justify-content: space-between !important;
            }
            .player-btn span {
                display: none !important;
            }
            .player-btn {
                padding: 8px !important;
                width: 40px !important;
                height: 40px !important;
                justify-content: center !important;
            }
            .episode-navigation {
                flex-direction: column !important;
                gap: 10px !important;
            }
        }

        /* ===== MOBILE MENU ACTIVE STATE ===== */
        @media (max-width: 992px) {
            nav.active ul {
                display: flex;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background-color: rgba(0, 0, 0, 0.95);
                padding: 20px;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
                z-index: 1000;
            }
            nav.active ul li {
                margin: 10px 0;
            }
        }

        /* ===== EPISODE CARD STYLES ===== */
        .episode-card {
            transition: all 0.3s ease;
        }
        .episode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        .episode-card img {
            transition: transform 0.5s;
        }
        .episode-card:hover img {
            transform: scale(1.1);
        }

        /* ===== VIDEO ERROR STYLES ===== */
        .video-error {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: center !important;
            align-items: center !important;
            background-color: rgba(0, 0, 0, 0.9) !important;
            z-index: 20 !important;
            color: white !important;
            text-align: center !important;
            padding: 20px !important;
        }

        /* ===== LOADING ANIMATION ===== */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        .video-loading i {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header id="mainHeader">
        <div class="logo">
            <i class="fas fa-play-circle"></i>
            <h1>DramaChina</h1>
        </div>
        
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        
        <nav id="mainNav">
            <ul>
                <li><a href="#" class="active" data-section="hero">Beranda</a></li>
                <li><a href="#" data-section="trending">Trending</a></li>
                <li><a href="#" data-section="latest">Terbaru</a></li>
                <li><a href="#" data-section="popular">Populer</a></li>
                <li><a href="#" data-section="about">Tentang</a></li>
            </ul>
        </nav>
        
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Cari drama...">
            <button id="searchBtn"><i class="fas fa-search"></i></button>
            
            <!-- Search Results Dropdown -->
            <div class="search-results" id="searchResults">
                <!-- Search results will be loaded here -->
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="hero">
        <div class="hero-content">
            <h2>Streaming Drama China Terlengkap</h2>
            <p>Nikmati berbagai drama China trending dan terbaru dengan subtitle Bahasa Indonesia. Streaming tanpa iklan dengan kualitas terbaik.</p>
            <button class="cta-button" id="exploreBtn">
                <i class="fas fa-play-circle"></i> Mulai Menonton
            </button>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Search Results Section -->
        <div class="search-results-section" id="searchResultsSection">
            <h2 class="section-title search-results-title" id="searchResultsTitle">
                <i class="fas fa-search"></i> Hasil Pencarian
            </h2>
            <div class="drama-grid" id="searchResultsGrid">
                <!-- Search results will be loaded here -->
            </div>
        </div>

        <!-- Trending Section -->
        <h2 class="section-title trending" id="trending">
            <i class="fas fa-fire"></i> Drama Trending
        </h2>
        
        <div class="drama-grid" id="trendingGrid">
            <div class="loading">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Memuat drama trending...</p>
            </div>
        </div>

        <!-- Latest Section -->
        <h2 class="section-title" id="latest">
            <i class="fas fa-star"></i> Drama Terbaru
        </h2>
        
        <div class="filter-container">
            <button class="filter-btn active" data-filter="all">
                <i class="fas fa-th-large"></i> Semua
            </button>
            <button class="filter-btn" data-filter="romance">
                <i class="fas fa-heart"></i> Romantis
            </button>
            <button class="filter-btn" data-filter="drama">
                <i class="fas fa-theater-masks"></i> Drama
            </button>
            <button class="filter-btn" data-filter="fantasy">
                <i class="fas fa-hat-wizard"></i> Fantasi
            </button>
            <button class="filter-btn" data-filter="hot">
                <i class="fas fa-fire"></i> Hot
            </button>
        </div>
        
        <div class="drama-grid" id="latestGrid">
            <div class="loading">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Memuat drama terbaru...</p>
            </div>
        </div>
        
        <!-- Popular Section -->
        <h2 class="section-title" id="popular">
            <i class="fas fa-chart-line"></i> Drama Populer
        </h2>
        <div class="drama-grid" id="popularGrid">
            <div class="loading">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Memuat drama populer...</p>
            </div>
        </div>
    </main>

    <!-- Drama Detail Modal -->
    <div class="drama-modal" id="dramaModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Judul Drama</h2>
                <button class="close-modal" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-poster">
                    <img id="modalPoster" src="" alt="Drama Poster" onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1574269909862-7e1d70bb8078?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';">
                </div>
                <div class="modal-info">
                    <h3 id="modalName">Judul Drama</h3>
                    <p id="modalDescription">Deskripsi drama akan muncul di sini.</p>
                    
                    <div class="modal-details">
                        <ul id="modalDetails">
                            <!-- Details will be added here -->
                        </ul>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="play-btn" id="playBtn">
                            <i class="fas fa-play"></i> Tonton Sekarang
                        </button>
                        <button class="trailer-btn" id="trailerBtn">
                            <i class="fas fa-film"></i> Lihat Trailer
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Player Modal -->
    <div class="drama-modal video-player-modal" id="videoPlayerModal">
        <div class="modal-content" style="max-width: 1000px; background-color: #000;">
            <div class="modal-header" style="background: linear-gradient(135deg, #000, #333);">
                <h2 id="playerTitle" style="color: white;">Video Player</h2>
                <div class="player-controls-top">
                    <button class="player-btn" id="qualityBtn" title="Quality">
                        <i class="fas fa-cog"></i> Quality
                    </button>
                    <button class="player-btn" id="subtitleBtn" title="Subtitles">
                        <i class="fas fa-closed-captioning"></i> Subtitles
                    </button>
                    <button class="player-btn" id="fullscreenBtn" title="Fullscreen">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="close-modal" id="closePlayer">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body" style="padding: 0; position: relative;">
                <!-- Video Container -->
                <div class="video-container" id="videoContainer">
                    <div class="video-loading" id="videoLoading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading video stream...</p>
                    </div>
                    
                    <!-- Video Element -->
                    <video id="mainVideoPlayer" class="video-js vjs-default-skin vjs-big-play-centered" 
                           controls preload="auto" playsinline>
                        <p class="vjs-no-js">
                            To view this video please enable JavaScript, and consider upgrading to a
                            web browser that <a href="https://videojs.com/html5-video-support/" target="_blank">
                            supports HTML5 video</a>
                        </p>
                    </video>
                    
                    <!-- Custom Controls -->
                    <div class="custom-controls" id="customControls">
                        <div class="progress-container">
                            <div class="progress-bar" id="progressBar">
                                <div class="progress-filled" id="progressFilled"></div>
                                <div class="progress-thumb" id="progressThumb"></div>
                            </div>
                            <div class="time-display">
                                <span id="currentTime">0:00</span> / <span id="durationTime">0:00</span>
                            </div>
                        </div>
                        
                        <div class="control-buttons">
                            <button class="control-btn" id="playPauseBtn">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="control-btn" id="rewindBtn">
                                <i class="fas fa-backward"></i> 10s
                            </button>
                            <button class="control-btn" id="forwardBtn">
                                <i class="fas fa-forward"></i> 10s
                            </button>
                            <button class="control-btn" id="volumeBtn">
                                <i class="fas fa-volume-up"></i>
                            </button>
                            <div class="volume-slider" id="volumeSlider">
                                <input type="range" min="0" max="100" value="100" id="volumeControl">
                            </div>
                            <button class="control-btn" id="pipBtn" title="Picture-in-Picture">
                                <i class="fas fa-picture-in-picture"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Video Info Panel -->
                <div class="video-info-panel" id="videoInfoPanel">
                    <div class="video-info-header">
                        <h3 id="videoEpisodeTitle">Episode 1</h3>
                        <div class="video-stats">
                            <span><i class="fas fa-eye"></i> <span id="viewCount">0</span> views</span>
                            <span><i class="fas fa-heart"></i> <span id="likeCount">0</span> likes</span>
                            <span><i class="fas fa-clock"></i> <span id="durationDisplay">0:00</span></span>
                        </div>
                    </div>
                    
                    <div class="video-description" id="videoDescription">
                        Loading video description...
                    </div>
                    
                    <div class="video-quality-info">
                        <div class="quality-badge" id="currentQualityBadge">
                            <i class="fas fa-hd"></i> <span id="currentQualityText">Auto</span>
                        </div>
                        <div class="resolution-info">
                            <i class="fas fa-expand-arrows-alt"></i> 
                            <span id="resolutionInfo">Loading...</span>
                        </div>
                    </div>
                </div>
                
                <!-- Quality Selection Modal -->
                <div class="quality-modal" id="qualityModal">
                    <div class="quality-modal-content">
                        <h3><i class="fas fa-cog"></i> Select Quality</h3>
                        <div class="quality-options" id="qualityOptions">
                            <div class="quality-option active" data-quality="auto">
                                <i class="fas fa-magic"></i>
                                <span>Auto (Recommended)</span>
                                <span class="quality-desc">Best for your connection</span>
                            </div>
                        </div>
                        <div class="quality-actions">
                            <button class="quality-btn" id="applyQuality">Apply</button>
                            <button class="quality-btn cancel" id="cancelQuality">Cancel</button>
                        </div>
                    </div>
                </div>
                
                <!-- Subtitle Selection Modal -->
                <div class="subtitle-modal" id="subtitleModal">
                    <div class="subtitle-modal-content">
                        <h3><i class="fas fa-closed-captioning"></i> Subtitles</h3>
                        <div class="subtitle-options" id="subtitleOptions">
                            <div class="subtitle-option active" data-subtitle="none">
                                <i class="fas fa-ban"></i>
                                <span>None</span>
                            </div>
                            <div class="subtitle-option" data-subtitle="id">
                                <i class="fas fa-flag"></i>
                                <span>Bahasa Indonesia</span>
                            </div>
                            <div class="subtitle-option" data-subtitle="en">
                                <i class="fas fa-flag-usa"></i>
                                <span>English</span>
                            </div>
                        </div>
                        <div class="subtitle-actions">
                            <button class="subtitle-btn" id="applySubtitle">Apply</button>
                            <button class="subtitle-btn cancel" id="cancelSubtitle">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Episode Navigation -->
            <div class="episode-navigation" id="episodeNavigation">
                <button class="episode-nav-btn prev" id="prevEpisode">
                    <i class="fas fa-chevron-left"></i> Previous Episode
                </button>
                <div class="episode-list-toggle" id="episodeListToggle">
                    <i class="fas fa-list"></i> Episode List
                </div>
                <button class="episode-nav-btn next" id="nextEpisode">
                    Next Episode <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <!-- Episode List Sidebar -->
            <div class="episode-sidebar" id="episodeSidebar">
                <div class="episode-sidebar-header">
                    <h3><i class="fas fa-film"></i> Episodes</h3>
                    <button class="close-sidebar" id="closeSidebar">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="episode-list" id="episodeList">
                    <!-- Episode list will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Modal -->
    <div class="drama-modal" id="customModal"></div>

    <!-- Loading Modal -->
    <div class="drama-modal" id="loadingModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-body" style="text-align: center; padding: 50px 30px;">
                <i class="fas fa-spinner fa-spin" style="color: var(--primary-color); font-size: 50px; margin-bottom: 20px;"></i>
                <h3 style="color: white; margin-bottom: 15px;">Memuat Detail Drama</h3>
                <p style="color: var(--text-secondary);">Harap tunggu sebentar...</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer id="about">
        <div class="footer-content">
            <div class="footer-column">
                <h3>DramaChina</h3>
                <p>Situs streaming drama China terlengkap dengan kualitas terbaik dan subtitle Bahasa Indonesia.</p>
                <div style="margin-top: 15px; display: flex; gap: 15px;">
                    <a href="#" style="color: var(--primary-color); font-size: 20px;">
                        <i class="fab fa-facebook"></i>
                    </a>
                    <a href="#" style="color: var(--primary-color); font-size: 20px;">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" style="color: var(--primary-color); font-size: 20px;">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="#" style="color: var(--primary-color); font-size: 20px;">
                        <i class="fab fa-youtube"></i>
                    </a>
                </div>
            </div>
            
            <div class="footer-column">
                <h3>Kategori</h3>
                <ul>
                    <li><a href="#"><i class="fas fa-chevron-right"></i> Drama Romantis</a></li>
                    <li><a href="#"><i class="fas fa-chevron-right"></i> Drama Fantasi</a></li>
                    <li><a href="#"><i class="fas fa-chevron-right"></i> Drama Sejarah</a></li>
                    <li><a href="#"><i class="fas fa-chevron-right"></i> Drama Modern</a></li>
                    <li><a href="#"><i class="fas fa-chevron-right"></i> Drama Keluarga</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>Menu</h3>
                <ul>
                    <li><a href="#" data-section="hero"><i class="fas fa-chevron-right"></i> Beranda</a></li>
                    <li><a href="#" data-section="trending"><i class="fas fa-chevron-right"></i> Trending</a></li>
                    <li><a href="#" data-section="latest"><i class="fas fa-chevron-right"></i> Terbaru</a></li>
                    <li><a href="#" data-section="popular"><i class="fas fa-chevron-right"></i> Populer</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>Kontak</h3>
                <ul>
                    <li><a href="#"><i class="fas fa-envelope"></i> support@dramachina.com</a></li>
                    <li><a href="#"><i class="fas fa-phone"></i> +62 812 3456 7890</a></li>
                    <li><a href="#"><i class="fas fa-map-marker-alt"></i> Jakarta, Indonesia</a></li>
                </ul>
            </div>
        </div>
        
        <div class="copyright">
            <p>&copy; <%= new Date().getFullYear() %> DramaChina. Semua hak dilindungi undang-undang. | Streaming drama China legal dan berlisensi.</p>
        </div>
    </footer>

    <!-- JavaScript Libraries -->
    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
    
    <!-- Main Application Script -->
    <script>
        // API URLs
        const API_BASE = '/api';
        const API_URL_LATEST = `${API_BASE}/latest`;
        const API_URL_TRENDING = `${API_BASE}/trending`;
        const API_URL_SEARCH = `${API_BASE}/search?query=`;
        const API_URL_DETAIL = `${API_BASE}/detail`;
        const API_URL_EPISODES = `${API_BASE}/episodes`;
        const API_URL_METADATA = `${API_BASE}/metadata`;
        const API_URL_SIMILAR = `${API_BASE}/similar`;
        const API_URL_STREAM = `${API_BASE}/stream`;
        const API_URL_STREAM_QUALITY = `${API_BASE}/stream-quality`;
        const API_URL_PLAYBACK = `${API_BASE}/playback`;
        const API_URL_VALIDATE = `${API_BASE}/validate`;
        const API_URL_SUBTITLES = `${API_BASE}/subtitles`;

        // DOM Elements
        const mainHeader = document.getElementById('mainHeader');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mainNav = document.getElementById('mainNav');
        const trendingGrid = document.getElementById('trendingGrid');
        const latestGrid = document.getElementById('latestGrid');
        const popularGrid = document.getElementById('popularGrid');
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const searchResults = document.getElementById('searchResults');
        const searchResultsSection = document.getElementById('searchResultsSection');
        const searchResultsTitle = document.getElementById('searchResultsTitle');
        const searchResultsGrid = document.getElementById('searchResultsGrid');
        const exploreBtn = document.getElementById('exploreBtn');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const dramaModal = document.getElementById('dramaModal');
        const closeModal = document.getElementById('closeModal');
        const playBtn = document.getElementById('playBtn');
        const trailerBtn = document.getElementById('trailerBtn');
        const navLinks = document.querySelectorAll('nav a, .footer-column a[data-section]');

        // Global variables
        let latestDramas = [];
        let trendingDramas = [];
        let filteredDramas = [];
        let searchDramas = [];
        let currentDrama = null;
        let currentDramaDetail = null;
        let currentEpisodes = [];
        let searchTimeout = null;
        let videoPlayer = null;
        let currentStreamData = null;
        let currentVideoId = null;
        let currentQuality = 'auto';
        let playerInitialized = false;
        let playbackHistory = [];

        // Fetch data from APIs
        async function fetchAllData() {
            try {
                // Fetch trending dramas
                const trendingResponse = await fetch(API_URL_TRENDING);
                const trendingData = await trendingResponse.json();
                
                if (trendingData && trendingData.books) {
                    trendingDramas = trendingData.books;
                    displayTrendingDramas();
                }
                
                // Fetch latest dramas
                const latestResponse = await fetch(API_URL_LATEST);
                const latestData = await latestResponse.json();
                
                if (latestData && latestData.books) {
                    latestDramas = latestData.books;
                    filteredDramas = [...latestDramas];
                    displayLatestDramas();
                    displayPopularDramas();
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                showError('Gagal memuat data. Silakan coba lagi nanti.');
            }
        }

        // Fetch drama detail
        async function fetchDramaDetail(dramaId) {
            try {
                showLoadingModal();
                
                const [detailResponse, episodesResponse, metadataResponse] = await Promise.all([
                    fetch(`${API_URL_DETAIL}/${dramaId}`),
                    fetch(`${API_URL_EPISODES}/${dramaId}?limit=10`),
                    fetch(`${API_URL_METADATA}/${dramaId}`)
                ]);
                
                const detailData = await detailResponse.json();
                const episodesData = await episodesResponse.json();
                const metadataData = await metadataResponse.json();
                
                if (detailData.code === 0 && detailData.data) {
                    currentDramaDetail = detailData.data;
                    currentEpisodes = episodesData.data?.episodes || [];
                    const metadata = metadataData.data;
                    
                    displayDramaDetail(detailData.data, metadata);
                    hideLoadingModal();
                    return true;
                } else {
                    throw new Error('Failed to fetch drama details');
                }
            } catch (error) {
                console.error('Error fetching drama detail:', error);
                hideLoadingModal();
                showModalError('Gagal memuat detail drama. Silakan coba lagi.');
                return false;
            }
        }

        // Display drama detail in modal
        function displayDramaDetail(detailData, metadata) {
            const videoData = detailData.video_data;
            
            if (!videoData) {
                showModalError('Data drama tidak tersedia.');
                return;
            }
            
            // Update modal title
            document.getElementById('modalTitle').textContent = videoData.series_title || 'Judul Drama';
            document.getElementById('modalName').textContent = videoData.series_title || 'Judul Drama';
            
            // Update description
            document.getElementById('modalDescription').textContent = 
                videoData.series_intro || 'Tidak ada deskripsi.';
            
            // Update poster
            const modalPoster = document.getElementById('modalPoster');
            modalPoster.src = videoData.series_cover || '';
            modalPoster.alt = videoData.series_title || 'Drama Poster';
            modalPoster.onerror = function() {
                this.onerror = null;
                this.src = 'https://images.unsplash.com/photo-1574269909862-7e1d70bb8078?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';
            };
            
            // Update modal details
            const detailsList = document.getElementById('modalDetails');
            
            // Parse categories
            let categories = 'Tidak ada kategori';
            try {
                if (videoData.category_schema) {
                    const parsedCategories = JSON.parse(videoData.category_schema);
                    categories = parsedCategories.map(cat => cat.name).join(', ');
                }
            } catch (e) {
                console.error('Error parsing categories:', e);
            }
            
            const totalEpisodes = videoData.episode_cnt || '0';
            const followerCount = videoData.followed_cnt ? videoData.followed_cnt.toLocaleString() : '0';
            const playCount = videoData.series_play_cnt ? videoData.series_play_cnt.toLocaleString() : '0';
            const ageRating = videoData.age_gate_info?.age_gate || '18';
            const status = videoData.series_status === 1 ? 'Sedang Tayang' : 'Selesai';
            
            detailsList.innerHTML = `
                <li><i class="fas fa-tags"></i> <strong>Kategori:</strong> ${categories}</li>
                <li><i class="fas fa-list-ol"></i> <strong>Total Episode:</strong> ${totalEpisodes}</li>
                <li><i class="fas fa-users"></i> <strong>Pengikut:</strong> ${followerCount}</li>
                <li><i class="fas fa-play-circle"></i> <strong>Ditonton:</strong> ${playCount} kali</li>
                <li><i class="fas fa-user-shield"></i> <strong>Rating Usia:</strong> ${ageRating}+</li>
                <li><i class="fas fa-check-circle"></i> <strong>Status:</strong> ${status}</li>
                <li><i class="fas fa-download"></i> <strong>Dapat Diunduh:</strong> ${videoData.download_config?.can_download ? 'Ya' : 'Tidak'}</li>
            `;
            
            // Update episode count in play button
            playBtn.innerHTML = `<i class="fas fa-play"></i> Tonton Episode 1 (dari ${totalEpisodes})`;
            
            // Update modal actions
            playBtn.onclick = () => {
                if (currentDramaDetail) {
                    playEpisode(1);
                }
            };
            
            trailerBtn.onclick = () => {
                if (currentDramaDetail) {
                    showTrailer();
                }
            };
            
            // Add episodes section if available
            addEpisodesSection();
            
            // Show modal
            dramaModal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // Add episodes section to modal
        function addEpisodesSection() {
            // Remove existing episodes section if any
            const existingEpisodesSection = document.querySelector('.modal-episodes-section');
            if (existingEpisodesSection) {
                existingEpisodesSection.remove();
            }
            
            if (currentEpisodes.length === 0) return;
            
            const modalInfo = document.querySelector('.modal-info');
            
            const episodesSection = document.createElement('div');
            episodesSection.className = 'modal-episodes-section';
            episodesSection.innerHTML = `
                <h3 style="margin-top: 30px; margin-bottom: 20px; color: white; border-bottom: 2px solid var(--primary-color); padding-bottom: 10px;">
                    <i class="fas fa-film"></i> Daftar Episode
                </h3>
                <div class="episodes-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    ${currentEpisodes.slice(0, 10).map((episode, index) => `
                        <div class="episode-card" style="background-color: var(--card-bg); border-radius: 8px; overflow: hidden; cursor: pointer; transition: transform 0.3s;" 
                             data-episode="${episode.vid_index}" data-vid="${episode.vid}">
                            <div class="episode-thumb" style="position: relative; height: 100px; overflow: hidden;">
                                <img src="${episode.cover || episode.episode_cover}" 
                                     alt="Episode ${episode.vid_index}"
                                     style="width: 100%; height: 100%; object-fit: cover;"
                                     onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1574269909862-7e1d70bb8078?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&q=80';">
                                <div class="episode-number" style="position: absolute; bottom: 5px; right: 5px; background-color: rgba(0,0,0,0.8); color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">
                                    ${episode.vid_index}
                                </div>
                            </div>
                            <div class="episode-info" style="padding: 10px;">
                                <div style="font-size: 12px; color: var(--text-secondary); display: flex; justify-content: space-between;">
                                    <span>${formatDuration(episode.duration || 0)}</span>
                                    <span>${episode.digged_count ? episode.digged_count.toLocaleString() : '0'} </span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                ${currentEpisodes.length > 10 ? `
                    <button id="loadMoreEpisodes" class="filter-btn" style="width: 100%; justify-content: center;">
                        <i class="fas fa-plus"></i> Muat Lebih Banyak Episode
                    </button>
                ` : ''}
            `;
            
            modalInfo.appendChild(episodesSection);
            
            // Add click event to episode cards
            document.querySelectorAll('.episode-card').forEach(card => {
                card.addEventListener('click', function() {
                    const episodeNumber = this.getAttribute('data-episode');
                    const vid = this.getAttribute('data-vid');
                    playEpisode(episodeNumber, vid);
                });
            });
            
            // Add click event to load more button
            const loadMoreBtn = document.getElementById('loadMoreEpisodes');
            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', loadMoreEpisodes);
            }
        }

        // Load more episodes
        async function loadMoreEpisodes() {
            try {
                if (!currentDrama) return;
                
                const currentCount = currentEpisodes.length;
                const response = await fetch(`${API_URL_EPISODES}/${currentDrama.book_id}?limit=20&page=${Math.ceil(currentCount / 20) + 1}`);
                const data = await response.json();
                
                if (data.code === 0 && data.data && data.data.episodes) {
                    currentEpisodes = [...currentEpisodes, ...data.data.episodes];
                    addEpisodesSection();
                    
                    // Scroll to episodes section
                    const episodesSection = document.querySelector('.modal-episodes-section');
                    if (episodesSection) {
                        episodesSection.scrollIntoView({ behavior: 'smooth' });
                    }
                }
            } catch (error) {
                console.error('Error loading more episodes:', error);
                showModalError('Gagal memuat episode tambahan.');
            }
        }

        // Play video stream
        async function playVideoStream(videoId, episodeInfo = {}) {
            try {
                initializeVideoPlayer();
                currentVideoId = videoId;
                
                // Show player
                const playerModal = document.getElementById('videoPlayerModal');
                playerModal.style.display = 'block';
                document.body.style.overflow = 'hidden';
                
                // Update episode info
                if (episodeInfo.title) {
                    document.getElementById('playerTitle').textContent = episodeInfo.title;
                    document.getElementById('videoEpisodeTitle').textContent = episodeInfo.title;
                }
                
                if (episodeInfo.description) {
                    document.getElementById('videoDescription').textContent = episodeInfo.description;
                }
                
                if (episodeInfo.episodeNumber) {
                    document.getElementById('playerTitle').textContent = `Episode ${episodeInfo.episodeNumber}`;
                }
                
                // Load video stream
                showPlayerLoading('Loading video stream...');
                await loadVideoStream(videoId, currentQuality);
                
                // Load available qualities
                await loadQualityOptions(videoId);
                
                // Load subtitles
                await loadSubtitles(videoId);
                
                // Load episode list if available
                if (episodeInfo.seriesId) {
                    await loadEpisodeList(episodeInfo.seriesId, episodeInfo.episodeNumber);
                }
                
                // Record playback start
                recordPlaybackStart(videoId, episodeInfo);
                
            } catch (error) {
                console.error('Error playing video:', error);
                showPlayerError('Failed to load video stream');
            }
        }

        // Load video stream
        async function loadVideoStream(videoId, quality = 'auto') {
            try {
                const response = await fetch(`${API_URL_STREAM_QUALITY}/${videoId}?quality=${quality}`);
                const data = await response.json();
                
                if (data.code === 0 && data.data) {
                    currentStreamData = data.data;
                    
                    // Get video URL
                    let videoUrl;
                    if (quality === 'auto' || !data.data.selected_url) {
                        videoUrl = data.data.main_url;
                    } else {
                        videoUrl = data.data.selected_url;
                    }
                    
                    // Validate URL
                    if (!videoUrl || !videoUrl.startsWith('http')) {
                        throw new Error('Invalid video URL');
                    }
                    
                    // Load video into player
                    const videoElement = videoPlayer || document.getElementById('mainVideoPlayer');
                    
                    if (videoPlayer) {
                        videoPlayer.src({
                            src: videoUrl,
                            type: 'video/mp4'
                        });
                        
                        // Add backup source if available
                        if (data.data.backup_url || data.data.selected_backup) {
                            videoPlayer.ready(() => {
                                const backupUrl = data.data.selected_backup || data.data.backup_url;
                                // In a real implementation, you would handle backup sources
                                console.log('Backup URL available:', backupUrl);
                            });
                        }
                        
                        videoPlayer.load();
                        videoPlayer.play().catch(e => {
                            console.log('Autoplay prevented:', e);
                            // Show play button
                        });
                    } else {
                        videoElement.src = videoUrl;
                        videoElement.load();
                        videoElement.play().catch(e => {
                            console.log('Autoplay prevented:', e);
                            // Show play button
                        });
                    }
                    
                    // Update UI with stream info
                    updateStreamInfoUI(data.data);
                    hidePlayerLoading();
                    
                    return true;
                } else {
                    throw new Error(data.message || 'Failed to load stream');
                }
            } catch (error) {
                console.error('Error loading video stream:', error);
                
                // Try fallback to basic stream endpoint
                try {
                    const fallbackResponse = await fetch(`${API_URL_STREAM}/${videoId}`);
                    const fallbackData = await fallbackResponse.json();
                    
                    if (fallbackData.code === 0 && fallbackData.data && fallbackData.data.main_url) {
                        // Use basic stream URL
                        const videoElement = videoPlayer || document.getElementById('mainVideoPlayer');
                        
                        if (videoPlayer) {
                            videoPlayer.src({
                                src: fallbackData.data.main_url,
                                type: 'video/mp4'
                            });
                            videoPlayer.load();
                        } else {
                            videoElement.src = fallbackData.data.main_url;
                            videoElement.load();
                        }
                        
                        updateStreamInfoUI(fallbackData.data);
                        hidePlayerLoading();
                        return true;
                    }
                } catch (fallbackError) {
                    console.error('Fallback also failed:', fallbackError);
                }
                
                throw error;
            }
        }

        // Initialize video player
        function initializeVideoPlayer() {
            if (playerInitialized) return;
            
            if (typeof videojs !== 'undefined') {
                videoPlayer = videojs('mainVideoPlayer', {
                    controls: false,
                    autoplay: false,
                    preload: 'auto',
                    responsive: true,
                    fluid: true,
                    playbackRates: [0.5, 0.75, 1, 1.25, 1.5, 2],
                    controlBar: false
                });
                
                // Setup video player events
                setupVideoPlayerEvents();
            }
            
            playerInitialized = true;
        }

        // Setup video player events
        function setupVideoPlayerEvents() {
            if (!videoPlayer) return;
            
            const videoElement = document.getElementById('mainVideoPlayer');
            const playPauseBtn = document.getElementById('playPauseBtn');
            const rewindBtn = document.getElementById('rewindBtn');
            const forwardBtn = document.getElementById('forwardBtn');
            const volumeBtn = document.getElementById('volumeBtn');
            const volumeControl = document.getElementById('volumeControl');
            const pipBtn = document.getElementById('pipBtn');
            const progressBar = document.getElementById('progressBar');
            const progressFilled = document.getElementById('progressFilled');
            const progressThumb = document.getElementById('progressThumb');
            const closePlayer = document.getElementById('closePlayer');
            
            // Video.js events
            videoPlayer.on('play', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            });
            
            videoPlayer.on('pause', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            });
            
            videoPlayer.on('timeupdate', () => {
                updateProgress();
            });
            
            videoPlayer.on('loadedmetadata', () => {
                updateDuration();
            });
            
            videoPlayer.on('volumechange', () => {
                updateVolumeUI();
            });
            
            // Play/Pause
            playPauseBtn.addEventListener('click', () => {
                if (videoPlayer.paused()) {
                    videoPlayer.play();
                } else {
                    videoPlayer.pause();
                }
            });
            
            // Rewind 10 seconds
            rewindBtn.addEventListener('click', () => {
                videoPlayer.currentTime(Math.max(0, videoPlayer.currentTime() - 10));
            });
            
            // Forward 10 seconds
            forwardBtn.addEventListener('click', () => {
                videoPlayer.currentTime(Math.min(videoPlayer.duration(), videoPlayer.currentTime() + 10));
            });
            
            // Volume control
            volumeControl.addEventListener('input', (e) => {
                videoPlayer.volume(e.target.value / 100);
            });
            
            // Close player
            closePlayer.addEventListener('click', closeVideoPlayer);
        }

        // Helper functions
        function formatDuration(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateProgress() {
            if (!videoPlayer) return;
            
            const currentTime = videoPlayer.currentTime();
            const duration = videoPlayer.duration();
            
            if (duration) {
                const percent = (currentTime / duration) * 100;
                document.getElementById('progressFilled').style.width = `${percent}%`;
                document.getElementById('progressThumb').style.left = `${percent}%`;
                
                document.getElementById('currentTime').textContent = formatTime(currentTime);
                document.getElementById('durationTime').textContent = formatTime(duration);
            }
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateDuration() {
            if (!videoPlayer) return;
            
            const duration = videoPlayer.duration();
            if (duration) {
                document.getElementById('durationTime').textContent = formatTime(duration);
                document.getElementById('durationDisplay').textContent = formatTime(duration);
            }
        }

        function updateVolumeUI() {
            if (!videoPlayer) return;
            
            const volume = videoPlayer.volume();
            document.getElementById('volumeControl').value = volume * 100;
            
            const volumeBtn = document.getElementById('volumeBtn');
            if (volume === 0) {
                volumeBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
            } else if (volume < 0.5) {
                volumeBtn.innerHTML = '<i class="fas fa-volume-down"></i>';
            } else {
                volumeBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
            }
        }

        // Update stream info UI
        function updateStreamInfoUI(streamData) {
            // Update resolution
            if (streamData.video_width && streamData.video_height) {
                document.getElementById('resolutionInfo').textContent = 
                    `${streamData.video_width}x${streamData.video_height}`;
            }
            
            // Update quality badge
            const qualityText = document.getElementById('currentQualityText');
            if (currentQuality === 'auto' && streamData.auto_definition) {
                qualityText.textContent = `Auto (${streamData.auto_definition})`;
            } else {
                qualityText.textContent = currentQuality === 'auto' ? 'Auto' : currentQuality.toUpperCase();
            }
            
            // Update quality badge class
            const qualityBadge = document.getElementById('currentQualityBadge');
            qualityBadge.className = `quality-badge ${currentQuality === 'auto' ? 'auto' : currentQuality}`;
        }

        // Show player loading
        function showPlayerLoading(message = 'Loading...') {
            const loadingEl = document.getElementById('videoLoading');
            if (loadingEl) {
                loadingEl.style.display = 'flex';
                loadingEl.querySelector('p').textContent = message;
            }
        }

        function hidePlayerLoading() {
            const loadingEl = document.getElementById('videoLoading');
            if (loadingEl) {
                loadingEl.style.display = 'none';
            }
        }

        // Show player error
        function showPlayerError(message) {
            const videoContainer = document.getElementById('videoContainer');
            const errorEl = document.createElement('div');
            errorEl.className = 'video-error';
            errorEl.innerHTML = `
                <div style="text-align: center; padding: 40px; color: white;">
                    <i class="fas fa-exclamation-triangle" style="font-size: 50px; color: var(--primary-color); margin-bottom: 20px;"></i>
                    <h3 style="margin-bottom: 15px;">Stream Error</h3>
                    <p style="margin-bottom: 20px; color: var(--text-secondary);">${message}</p>
                    <button onclick="retryVideoStream()" class="watch-btn" style="padding: 12px 30px;">
                        <i class="fas fa-redo"></i> Try Again
                    </button>
                </div>
            `;
            
            // Remove existing error
            const existingError = videoContainer.querySelector('.video-error');
            if (existingError) {
                existingError.remove();
            }
            
            videoContainer.appendChild(errorEl);
            hidePlayerLoading();
        }

        // Retry video stream
        async function retryVideoStream() {
            if (currentVideoId) {
                const errorEl = document.querySelector('.video-error');
                if (errorEl) errorEl.remove();
                
                showPlayerLoading('Retrying...');
                await loadVideoStream(currentVideoId, currentQuality);
            }
        }

        // Close video player
        function closeVideoPlayer() {
            const playerModal = document.getElementById('videoPlayerModal');
            if (playerModal) {
                playerModal.style.display = 'none';
                document.body.style.overflow = 'auto';
                
                // Pause video
                if (videoPlayer) {
                    videoPlayer.pause();
                }
            }
        }

        // Play episode
        async function playEpisode(episodeNumber, vid = null, episodeInfo = {}) {
            try {
                // If we have episode info with video ID, use it directly
                if (vid) {
                    await playVideoStream(vid, {
                        title: `Episode ${episodeNumber}`,
                        description: episodeInfo.title || 'No description available',
                        episodeNumber: episodeNumber,
                        seriesId: episodeInfo.series_id || currentDramaDetail?.video_data?.series_id_str
                    });
                    return;
                }
                
                // Otherwise, try to find the video ID from current episodes
                if (currentEpisodes && currentEpisodes.length > 0) {
                    const episode = currentEpisodes.find(ep => 
                        ep.vid_index == episodeNumber || ep.vid === vid
                    );
                    
                    if (episode && episode.vid) {
                        await playVideoStream(episode.vid, {
                            title: `Episode ${episodeNumber}`,
                            description: episode.title || 'No description available',
                            episodeNumber: episodeNumber,
                            seriesId: episode.series_id
                        });
                    } else {
                        showCustomModal('Episode Tidak Ditemukan', `
                            <div style="text-align: center;">
                                <p>Episode ${episodeNumber} tidak ditemukan.</p>
                                <button onclick="closeCustomModal()" class="watch-btn">
                                    Tutup
                                </button>
                            </div>
                        `, true);
                    }
                } else {
                    // Fallback to simulation mode
                    showCustomModal('Streaming Dimulai', `
                        <div style="text-align: center;">
                            <h3 style="margin-bottom: 20px; color: var(--primary-color);">
                                <i class="fas fa-play-circle"></i> Memulai Streaming
                            </h3>
                            <p style="margin-bottom: 20px;">
                                Episode <strong>${episodeNumber}</strong> akan segera dimulai...
                            </p>
                            <div style="background-color: var(--light-bg); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                                <p style="color: var(--text-secondary); font-style: italic;">
                                    "Player video akan muncul di sini"
                                </p>
                            </div>
                            <p style="font-size: 14px; color: var(--text-secondary);">
                                <i class="fas fa-info-circle"></i> Untuk streaming langsung, pastikan API stream tersedia.
                            </p>
                            <div style="margin-top: 30px;">
                                <button onclick="testStreamAPI()" class="trailer-btn" style="margin-right: 10px;">
                                    <i class="fas fa-video"></i> Test Stream API
                                </button>
                                <button onclick="closeCustomModal()" class="watch-btn">
                                    <i class="fas fa-times"></i> Tutup
                                </button>
                            </div>
                        </div>
                    `, false);
                }
            } catch (error) {
                console.error('Error playing episode:', error);
                showModalError('Gagal memulai streaming: ' + error.message);
            }
        }

        // Show custom modal
        function showCustomModal(title, content, showClose = true) {
            const modal = document.getElementById('customModal');
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h2>${title}</h2>
                        ${showClose ? `<button class="close-modal" onclick="closeCustomModal()">
                            <i class="fas fa-times"></i>
                        </button>` : ''}
                    </div>
                    <div class="modal-body" style="padding: 30px;">
                        ${content}
                    </div>
                </div>
            `;
            
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeCustomModal() {
            const modal = document.getElementById('customModal');
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        function showLoadingModal() {
            document.getElementById('loadingModal').style.display = 'block';
        }

        function hideLoadingModal() {
            document.getElementById('loadingModal').style.display = 'none';
        }

        function showModalError(message) {
            showCustomModal('Terjadi Kesalahan', `
                <div style="text-align: center;">
                    <div style="margin-bottom: 20px;">
                        <i class="fas fa-exclamation-triangle" style="color: #ff6b00; font-size: 50px;"></i>
                    </div>
                    <p style="margin-bottom: 20px; font-size: 18px;">${message}</p>
                    <button onclick="closeCustomModal()" class="watch-btn" style="padding: 12px 30px;">
                        <i class="fas fa-times"></i> Tutup
                    </button>
                </div>
            `, true);
        }

        // Add to global scope
        window.playEpisode = playEpisode;
        window.closeCustomModal = closeCustomModal;
        window.retryVideoStream = retryVideoStream;

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            fetchAllData();
            
            // Header scroll effect
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    mainHeader.classList.add('scrolled');
                } else {
                    mainHeader.classList.remove('scrolled');
                }
            });
            
            // Initialize video player when video.js loads
            if (typeof videojs !== 'undefined') {
                initializeVideoPlayer();
            }
        });
    </script>
</body>
</html>
